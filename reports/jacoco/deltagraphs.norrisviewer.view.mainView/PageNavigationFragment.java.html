<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>PageNavigationFragment.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">app</a> &gt; <a href="index.source.html" class="el_package">deltagraphs.norrisviewer.view.mainView</a> &gt; <span class="el_source">PageNavigationFragment.java</span></div><h1>PageNavigationFragment.java</h1><pre class="source lang-java linenums">package deltagraphs.norrisviewer.view.mainView;

import android.support.v7.app.ActionBarActivity;
import android.app.Activity;
import android.support.v7.app.ActionBar;
import android.support.v4.app.Fragment;
import android.support.v4.app.ActionBarDrawerToggle;
import android.support.v4.view.GravityCompat;
import android.support.v4.widget.DrawerLayout;
import android.content.SharedPreferences;
import android.content.res.Configuration;
import android.os.Bundle;
import android.preference.PreferenceManager;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.Toast;

import deltagraphs.norrisviewer.R;

/**
 * Fragment used for managing interactions for and presentation of a navigation drawer.
 * See the &lt;a href=&quot;https://developer.android.com/design/patterns/navigation-drawer.html#Interaction&quot;&gt;
 * design guidelines&lt;/a&gt; for a complete explanation of the behaviors implemented here.
 */
public class    PageNavigationFragment extends Fragment {

    /**
     * Remember the position of the selected item.
     */
    private static final String STATE_SELECTED_POSITION = &quot;selected_navigation_drawer_position&quot;;

    /**
     * Per the design guidelines, you should show the drawer on launch until the user manually
     * expands it. This shared preference tracks this.
     */
    private static final String PREF_USER_LEARNED_DRAWER = &quot;navigation_drawer_learned&quot;;

    /**
     * A pointer to the current callbacks instance (the Activity).
     */
    private NavigationDrawerCallbacks mCallbacks;

    /**
     * Helper component that ties the action bar to the navigation drawer.
     */
    private ActionBarDrawerToggle mDrawerToggle;

    private DrawerLayout mDrawerLayout;
    private ListView mDrawerListView;
    private View mFragmentContainerView;

<span class="nc" id="L59">    private int mCurrentSelectedPosition = 0;</span>
    private boolean mFromSavedInstanceState;
    private boolean mUserLearnedDrawer;

<span class="nc" id="L63">    public PageNavigationFragment() {</span>
<span class="nc" id="L64">    }</span>

    @Override
    public void onCreate(Bundle savedInstanceState) {
<span class="nc" id="L68">        super.onCreate(savedInstanceState);</span>

        // Read in the flag indicating whether or not the user has demonstrated awareness of the
        // drawer. See PREF_USER_LEARNED_DRAWER for details.
<span class="nc" id="L72">        SharedPreferences sp = PreferenceManager.getDefaultSharedPreferences(getActivity());</span>
<span class="nc" id="L73">        mUserLearnedDrawer = sp.getBoolean(PREF_USER_LEARNED_DRAWER, false);</span>

<span class="nc bnc" id="L75" title="All 2 branches missed.">        if (savedInstanceState != null) {</span>
<span class="nc" id="L76">            mCurrentSelectedPosition = savedInstanceState.getInt(STATE_SELECTED_POSITION);</span>
<span class="nc" id="L77">            mFromSavedInstanceState = true;</span>
        }

        // Select either the default item (0) or the last selected item.
<span class="nc" id="L81">        selectItem(mCurrentSelectedPosition);</span>
<span class="nc" id="L82">    }</span>

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
<span class="nc" id="L86">        super.onActivityCreated(savedInstanceState);</span>
        // Indicate that this fragment would like to influence the set of actions in the action bar.
<span class="nc" id="L88">        setHasOptionsMenu(true);</span>
<span class="nc" id="L89">    }</span>

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
<span class="nc" id="L94">        mDrawerListView = (ListView) inflater.inflate(</span>
                R.layout.fragment_navigation_drawer, container, false);
<span class="nc" id="L96">        mDrawerListView.setOnItemClickListener(new AdapterView.OnItemClickListener() {</span>
            @Override
            public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position, long id) {
<span class="nc" id="L99">                selectItem(position);</span>
<span class="nc" id="L100">            }</span>
        });
<span class="nc" id="L102">        mDrawerListView.setAdapter(new ArrayAdapter&lt;String&gt;(</span>
                getActionBar().getThemedContext(),
                android.R.layout.simple_list_item_activated_1,
                android.R.id.text1,
                MainActivity.pagesList));
<span class="nc" id="L107">        mDrawerListView.setItemChecked(mCurrentSelectedPosition, true);</span>
<span class="nc" id="L108">        return mDrawerListView;</span>
    }

    public boolean isDrawerOpen() {
<span class="nc bnc" id="L112" title="All 4 branches missed.">        return mDrawerLayout != null &amp;&amp; mDrawerLayout.isDrawerOpen(mFragmentContainerView);</span>
    }

    /**
     * Users of this fragment must call this method to set up the navigation drawer interactions.
     *
     * @param fragmentId   The android:id of this fragment in its activity's layout.
     * @param drawerLayout The DrawerLayout containing this fragment's UI.
     */
    public void setUp(int fragmentId, DrawerLayout drawerLayout) {
<span class="nc" id="L122">        mFragmentContainerView = getActivity().findViewById(fragmentId);</span>
<span class="nc" id="L123">        mDrawerLayout = drawerLayout;</span>

        // set a custom shadow that overlays the main content when the drawer opens
<span class="nc" id="L126">        mDrawerLayout.setDrawerShadow(R.drawable.drawer_shadow, GravityCompat.START);</span>
        // set up the drawer's list view with items and click listener

<span class="nc" id="L129">        ActionBar actionBar = getActionBar();</span>
<span class="nc" id="L130">        actionBar.setDisplayHomeAsUpEnabled(true);</span>
<span class="nc" id="L131">        actionBar.setHomeButtonEnabled(true);</span>

        // ActionBarDrawerToggle ties together the the proper interactions
        // between the navigation drawer and the action bar app icon.
<span class="nc" id="L135">        mDrawerToggle = new ActionBarDrawerToggle(</span>
                getActivity(),                    /* host Activity */
                mDrawerLayout,                    /* DrawerLayout object */
                R.drawable.ic_drawer,             /* nav drawer image to replace 'Up' caret */
                R.string.navigation_drawer_open,  /* &quot;open drawer&quot; description for accessibility */
                R.string.navigation_drawer_close  /* &quot;close drawer&quot; description for accessibility */
<span class="nc" id="L141">        ) {</span>
            @Override
            public void onDrawerClosed(View drawerView) {
<span class="nc" id="L144">                super.onDrawerClosed(drawerView);</span>
<span class="nc bnc" id="L145" title="All 2 branches missed.">                if (!isAdded()) {</span>
<span class="nc" id="L146">                    return;</span>
                }

<span class="nc" id="L149">                getActivity().supportInvalidateOptionsMenu(); // calls onPrepareOptionsMenu()</span>
<span class="nc" id="L150">            }</span>

            @Override
            public void onDrawerOpened(View drawerView) {
<span class="nc" id="L154">                super.onDrawerOpened(drawerView);</span>
<span class="nc bnc" id="L155" title="All 2 branches missed.">                if (!isAdded()) {</span>
<span class="nc" id="L156">                    return;</span>
                }

<span class="nc bnc" id="L159" title="All 2 branches missed.">                if (!mUserLearnedDrawer) {</span>
                    // The user manually opened the drawer; store this flag to prevent auto-showing
                    // the navigation drawer automatically in the future.
<span class="nc" id="L162">                    mUserLearnedDrawer = true;</span>
<span class="nc" id="L163">                    SharedPreferences sp = PreferenceManager</span>
                            .getDefaultSharedPreferences(getActivity());
<span class="nc" id="L165">                    sp.edit().putBoolean(PREF_USER_LEARNED_DRAWER, true).apply();</span>
                }

<span class="nc" id="L168">                getActivity().supportInvalidateOptionsMenu(); // calls onPrepareOptionsMenu()</span>
<span class="nc" id="L169">            }</span>
        };

        // If the user hasn't 'learned' about the drawer, open it to introduce them to the drawer,
        // per the navigation drawer design guidelines.
<span class="nc bnc" id="L174" title="All 4 branches missed.">        if (!mUserLearnedDrawer &amp;&amp; !mFromSavedInstanceState) {</span>
<span class="nc" id="L175">            mDrawerLayout.openDrawer(mFragmentContainerView);</span>
        }

        // Defer code dependent on restoration of previous instance state.
<span class="nc" id="L179">        mDrawerLayout.post(new Runnable() {</span>
            @Override
            public void run() {
<span class="nc" id="L182">                mDrawerToggle.syncState();</span>
<span class="nc" id="L183">            }</span>
        });

<span class="nc" id="L186">        mDrawerLayout.setDrawerListener(mDrawerToggle);</span>
<span class="nc" id="L187">    }</span>

    private void selectItem(int position) {
<span class="nc" id="L190">        mCurrentSelectedPosition = position;</span>
<span class="nc bnc" id="L191" title="All 2 branches missed.">        if (mDrawerListView != null) {</span>
<span class="nc" id="L192">            mDrawerListView.setItemChecked(position, true);</span>
        }
<span class="nc bnc" id="L194" title="All 2 branches missed.">        if (mDrawerLayout != null) {</span>
<span class="nc" id="L195">            mDrawerLayout.closeDrawer(mFragmentContainerView);</span>
        }
<span class="nc bnc" id="L197" title="All 2 branches missed.">        if (mCallbacks != null) {</span>
<span class="nc" id="L198">            mCallbacks.onNavigationDrawerItemSelected(position);</span>
        }
<span class="nc" id="L200">    }</span>

    @Override
    public void onAttach(Activity activity) {
<span class="nc" id="L204">        super.onAttach(activity);</span>
        try {
<span class="nc" id="L206">            mCallbacks = (NavigationDrawerCallbacks) activity;</span>
<span class="nc" id="L207">        } catch (ClassCastException e) {</span>
<span class="nc" id="L208">            throw new ClassCastException(&quot;Activity must implement NavigationDrawerCallbacks.&quot;);</span>
<span class="nc" id="L209">        }</span>
<span class="nc" id="L210">    }</span>

    @Override
    public void onDetach() {
<span class="nc" id="L214">        super.onDetach();</span>
<span class="nc" id="L215">        mCallbacks = null;</span>
<span class="nc" id="L216">    }</span>

    @Override
    public void onSaveInstanceState(Bundle outState) {
<span class="nc" id="L220">        super.onSaveInstanceState(outState);</span>
<span class="nc" id="L221">        outState.putInt(STATE_SELECTED_POSITION, mCurrentSelectedPosition);</span>
<span class="nc" id="L222">    }</span>

    @Override
    public void onConfigurationChanged(Configuration newConfig) {
<span class="nc" id="L226">        super.onConfigurationChanged(newConfig);</span>
        // Forward the new configuration the drawer toggle component.
<span class="nc" id="L228">        mDrawerToggle.onConfigurationChanged(newConfig);</span>
<span class="nc" id="L229">    }</span>

    @Override
    public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
        // If the drawer is open, show the global app actions in the action bar. See also
        // showGlobalContextActionBar, which controls the top-left area of the action bar.
<span class="nc bnc" id="L235" title="All 4 branches missed.">        if (mDrawerLayout != null &amp;&amp; isDrawerOpen()) {</span>
<span class="nc" id="L236">            inflater.inflate(R.menu.global, menu);</span>
<span class="nc" id="L237">            showGlobalContextActionBar();</span>
        }
<span class="nc" id="L239">        super.onCreateOptionsMenu(menu, inflater);</span>
<span class="nc" id="L240">    }</span>

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
<span class="nc bnc" id="L244" title="All 2 branches missed.">        if (mDrawerToggle.onOptionsItemSelected(item)) {</span>
<span class="nc" id="L245">            return true;</span>
        }

        /*if (item.getItemId() == R.id.action_example) {
            Toast.makeText(getActivity(), &quot;Example action.&quot;, Toast.LENGTH_SHORT).show();
            return true;
        }
        */
<span class="nc" id="L253">        return super.onOptionsItemSelected(item);</span>
    }

    /**
     * Per the navigation drawer design guidelines, updates the action bar to show the global app
     * 'context', rather than just what's in the current screen.
     */
    private void showGlobalContextActionBar() {
<span class="nc" id="L261">        ActionBar actionBar = getActionBar();</span>
<span class="nc" id="L262">        actionBar.setDisplayShowTitleEnabled(true);</span>
<span class="nc" id="L263">        actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_STANDARD);</span>
<span class="nc" id="L264">        actionBar.setTitle(R.string.app_name);</span>
<span class="nc" id="L265">    }</span>

    private ActionBar getActionBar() {
<span class="nc" id="L268">        return ((ActionBarActivity) getActivity()).getSupportActionBar();</span>
    }

    /**
     * Callbacks interface that all activities using this fragment must implement.
     */
    public static interface NavigationDrawerCallbacks {
        /**
         * Called when an item in the navigation drawer is selected.
         */
        void onNavigationDrawerItemSelected(int position);
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.4.201502262128</span></div></body></html>