<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../resources/report.css" type="text/css"/><link rel="shortcut icon" href="../resources/report.gif" type="image/gif"/><title>MapChartPresenterImpl.java</title><link rel="stylesheet" href="../resources/prettify.css" type="text/css"/><script type="text/javascript" src="../resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">app</a> &gt; <a href="index.source.html" class="el_package">deltagraphs.norrisviewer.presenter.graphsPresenter</a> &gt; <span class="el_source">MapChartPresenterImpl.java</span></div><h1>MapChartPresenterImpl.java</h1><pre class="source lang-java linenums">package deltagraphs.norrisviewer.presenter.graphsPresenter;

/*
 * Name : MapChartPresenterImpl.java
 * Module : deltagraphs.norrisviewer.presenter.graphsPresenter
 * Location : norrisviewer\presenter\graphsPresenter
 *
 * History :

 * Version Date Programmer Description
 * ===============================================================
 *
 * 0.1.1 2015-06-05 Davide Trivellato Update method update(Observable observable, Object data)
 *
 * 0.1.0 2015-06-04 Davide Trivellato Coding of all methods and attributes
 *
 * 0.0.1 2015-06-03 Davide Trivellato Creation of the file
 *
 * ===============================================================
 *
 */

import android.util.Log;

import java.util.Observable;

import deltagraphs.norrisviewer.model.graphsModel.*;
import deltagraphs.norrisviewer.view.graphsView.*;

public class MapChartPresenterImpl extends GraphPresenter implements MapChartPresenter {

    protected MapChartView graphView;
    protected MapChart mapChartInstance;

    /* constructor of MapChartPresenterImpl. It requires an activity and an url to be instatiated properly.
    The object will be associated to the activity and a new connection will be established with the
    given url. Furthermore, an instance of mapchart model will be created. The object will observe the
    changes on it, according to the observer design pattern. */
    public MapChartPresenterImpl(MapChartView view, String url) {
<span class="fc" id="L40">        super(url);</span>
<span class="fc" id="L41">        graphView = view;</span>
<span class="fc" id="L42">        mapChartInstance = new MapChartImpl(this);</span>
<span class="fc" id="L43">        startSocket((MapChartActivity) view, mapChartInstance);</span>
<span class="fc" id="L44">    }</span>

    /* this method is always called by the method &quot;update&quot;.
    Its objective is to set graph parameters, extracting the informations from the model. */
    private void setGraphParameters() {
<span class="fc" id="L49">        graphView.cameraPosition(mapChartInstance.getLatitude(),</span>
                mapChartInstance.getLongitude()
        );
<span class="fc" id="L52">        graphView.setZoom(mapChartInstance.getMapWidth(), mapChartInstance.getMapHeight());</span>
<span class="fc" id="L53">        graphView.setLegendOnPoint(mapChartInstance.getLegendOnPoint());</span>
<span class="fc" id="L54">        graphView.setMapType(mapChartInstance.getMapType());</span>
<span class="fc" id="L55">    }</span>

    /* This object is an observer of the map chart model. When there are some changes on it, a signal is sent
    to this object and the following method is called. Its aim is to set or update informations that are
    shown on the activity. Data is always updated on it. In some cases, when a signal arrives with the value
    &quot;configGraph&quot; or &quot;updateGraphProp&quot;, there is also an update of the graph parameters, on the activity.
    All of these informations are extracted from the model.*/
    @Override
    public void update(Observable observable, Object data) {
<span class="pc bpc" id="L64" title="1 of 2 branches missed.">        if (observable instanceof MapChartImpl) {</span>
<span class="fc" id="L65">            String signal = (String) data;</span>
<span class="pc bpc" id="L66" title="3 of 4 branches missed.">            if ((signal == &quot;configGraph&quot;) || (signal == &quot;updateGraphProp&quot;))</span>
<span class="fc" id="L67">                setGraphParameters();</span>
<span class="fc" id="L68">            graphView.setData(mapChartInstance.getFlowList(), signal);</span>
        }
<span class="fc" id="L70">        Log.d(&quot;&quot;, &quot;update map&quot;);</span>
<span class="fc" id="L71">    }</span>

    //when called, the socket connection is stopped
    public void stopConnection() {
<span class="fc" id="L75">        stopSocket();</span>
<span class="fc" id="L76">    }</span>

    //when called, the socket connection is started
    public void startConnection() {
<span class="fc" id="L80">        startSocket((MapChartActivity) graphView, mapChartInstance);</span>
<span class="fc" id="L81">    }</span>

    @Override
    public void startListening() {
<span class="nc" id="L85">        super.startListening((MapChartActivity)graphView, mapChartInstance);</span>
<span class="nc" id="L86">    }</span>

}

</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.4.201502262128</span></div></body></html>